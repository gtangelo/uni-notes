## Assignment 4 - Gabriel Angelo Ting (z5312799)

**2. You have $n$ warehouses and $n$ shops. At each warehouse, a truck is loaded with enough goods to supply one shop. There are $m$ roads, each going from a warehouse to a shop, and driving along the $i^{th}$ road takes $d_i$ hours, where $d_i$​ is an integer. Design a polynomial time algorithm to send the trucks to the shops, minimising the time until all shops are supplied. (25 pts)**

*Hint: Combine a binary search with a max flow. By sorting you can assume that $d_i$​ form an increasing sequence. Fix $i$​ and consider only roads which take $\le d_i$​ hours to travel from a warehouse to the corresponding shop and use max flow to see if they are enough to obtain a matching of warehouses with shops which is of size $n$​. Use a binary search on $i$​ to find the smallest $d_i$​ which meets the requirements.*

This problem can be represented as a max flow problem. Construct a bipartite graph $G(V, E)$ where all of the warehouses are represented as the vertices on the left side and all shops as vertices on the right side of the graph. Edges are represented as roads connecting a warehouse to a shop. Construct a super source $S$ and super sink $T$. Connect $S$ to all warehouses and connect $T$ to all shops and set edges with a maximum capacity 1 as it ensures that every warehouse will supply up to one shop only.

Lets create an array of size $m$​​ where each element represents $d_i$​​ hours for each $m$​​ roads. Use a merge sort to sort the array by $d_i$​​ in increasing order. This operation costs $O(m\log{m})$​​. To find the minimum time until all shops are supplied, we need to find the combination of roads such that for each truck, the smallest possible $d_i$​ road is​ travelled along to supply all shops. Hence, we need to find the least upper bound $d_i$​​ such that it minimises the time until all shops are supplied.

We can achieve this by performing a binary search on the sorted array of roads and finding the smallest $d_i$ which meets the requirements. For each binary search on the $i^{th}$ element, reconstruct the edges each time in the flow network $G$ such we are only considering roads where it will take $\le d_i$ hours to drive from the warehouse to the shops. Set these edges with a maximum capacity 1. Then, using the Edmonds-Karp algorithm, find the maximum flow of the network. This gives us the complexity of $O(|V| |E|^2)$. After the algorithm converges, find the minimum cut which gives us how many shops can be supplied by each warehouse. Keep performing the binary search until we have found the smallest $d_i$ that gives us a matching where all warehouses are supplying all. Otherwise, there exists no paths in the network that ensures all shops can be supplied.

In this algorithm, the highest cost operation occurs as for each binary search, we are performing the Edmonds-Karp algorithm each time to find the max flow. Since we are a performing a binary search on an array containing $m$​​​​​​​ elements, the time complexity of this operation is $O(\log{m})$​​​​​​​. For each binary search, we are performing the Edmonds-Karp algorithm to find the smallest $d_i$​​​​​​​ that minimises the time until all shops are supplied. We know that the Edmonds-Karp algorithm runs in $O(|V| \times |E|^2)$​​​​​​​ where $V$​​​​​​​ are the vertices and $E$​​​​​​​ are the edges of the graph.​ Since there are $2n + 2 = O(n)$​​​​​​​ vertices ($n$​​​​​​​ warehouses, $n$​​​​​​​ shops and the super source/sink nodes) and $m + 2n = O(m+n)$​​​​​​​​ edges (edges from the super source/sinks to the warehouses/shops and the $m$​​​​​​​​ roads), the overall time complexity for this algorithm is given by $O((2n + 2) \times (m + 2n)^2 \times \log{m}) = O(n \times (m + n)^2 \times \log{m}) $​​​​​​​​​.

