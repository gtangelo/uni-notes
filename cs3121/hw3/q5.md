## Assignment 3 - Gabriel Angelo Ting (z5312799)

**5. Given a weighted directed graph $G(V, E)$, find a path in $G$ (possibly selfintersecting) of length exactly $K$ that has the maximum total weight. The path can visit a vertex multiple times and can traverse an edge also multiple times. It can also start and end at arbitrary vertices or even start and end at the same vertex. (20 pts)**

To solve this problem, we need to solve the subproblem to find the maximum weighted path of length $k$​​​​​, where $1 \le k \le K$​​​​​, for every vertex $v$​​​​​, where $1 \le v \le |V|$​​​​​. Let there exists $P(v, k)$​​​​​ which finds the value of the maximum weighted path with length exactly $k$​​​​​ which ends at vertex $v$​​​​​. Let $W(v,w)$​​​​​ represent the weight of the edge from vertex $v$​​​​​ to $w$​​​​​. The base case of $P(v,k)$​​​​​ is $P(v, 0) = 0$​​​​​ since there exists no weighted path when $k=0$​​​​. To find the optimal solution, the recursion is defined as follows:
$$
P(v,k) = \max\{P(w, k-1) + W(w,v)\} \text{ for all $w$ which has an edge from $w$ to $v$}
$$
In this recusive solution, first we are considering all vertices $w$​ that has an incoming edge connected to $v$​. Then, out of all vertices $w$​, we are finding the maximum weighted path when connected to $v$​​ and caching each results throughout the recursive calls using memoization. This allows us to find that for any vertex $v$​, the maximum weighted path at length $k$​​.

To obtain the final solution, we first initialise a $|V| \times K$​​​​ matrix where each cell $(v, k)$​​​​​​​ stores two values:

- the $w$​​​ vertex that is the result of the operation $\max\{P(w, k-1) + W(v,w)\}$​​​​​​, and
- $P(v,k)$​​ which represents the weight of the maximum weighted path (such that we are caching our results in the computation)

We then make a recusive call to $P(v,k)$​​ for every $1\le k \le K$​. For each recusive call, we are iterating up to $|V|$​​ vertices since we are finding all possibilities, caching the computations made in the process for $P(v,k)$​ in the $|V| \times K$​​​​​ matrix.

After computing all subproblems, for all $P(K,v)$, we must find the vertex that has the maximum total weight which can be done in linear time by searching for the maximum weight that is stored in each cell of the last column in the $|V| \times K$ matrix. After determining the vertex with the maximum total weight of length exactly $K$, we can use the $w$​​​ vertex that is also stored in each cell of the matrix, as defined earlier, to backtrack in the matrix table to find the path sequence.

For each $k$ length, $1 \le k \le K$, it takes $O(|V| + |E|)$ since we are finding the maximum weighted graph from all vertex, $V$, and the incoming edges, $E$. We are iterating over the $O(|V|+|E|)$ operation by $O(K)$ times to find the most optimal solution. Thus, the overall time complexity for this algorithm is $O(K\times(|V|+|E|))$​​​​.
